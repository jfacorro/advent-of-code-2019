(ns advent.test.day-10
  (:require [clojure.test :refer :all]
            [advent.day-10 :refer :all]))

(deftest test-line-of-sight
  (are [from to line] (and (= line (line-of-sight from to))
                           (= (reverse line) (line-of-sight to from)))
    ;; Horizontal
    [0 0] [3 0] [[1 0] [2 0]]
    ;; Vertical
    [0 0] [0 3] [[0 1] [0 2]]
    ;; Top-left <-> bottom right
    [0 0] [9 3] [[3 1] [6 2]] ; A
    [0 0] [9 6] [[3 2] [6 4]] ; B
    [0 0] [9 9] [[1 1] [2 2] [3 3] [4 4] [5 5] [6 6] [7 7] [8 8]] ; C
    [0 0] [6 9] [[2 3] [4 6]] ; D
    [0 0] [3 9] [[1 3] [2 6]] ; E
    [0 0] [4 8] [[1 2] [2 4] [3 6]] ; F
    [0 0] [8 6] [[4 3]] ; G
    ;; Bottom-left <-> top-right
    [0 9] [9 6] [[3 8] [6 7]]

    ))

(deftest test-part-one
  (testing "Examples for part 1"
    (are [input result] (= result (part-one (input->map input)))
      [".#..#"
       "....."
       "#####"
       "....#"
       "...##"]
      8

      ["......#.#."
       "#..#.#...."
       "..#######."
       ".#.#.###.."
       ".#..#....."
       "..#....#.#"
       "#..#....#."
       ".##.#..###"
       "##...#..#."
       ".#....####"]
      33

      ["#.#...#.#."
       ".###....#."
       ".#....#..."
       "##.#.#.#.#"
       "....#.#.#."
       ".##..###.#"
       "..#...##.."
       "..##....##"
       "......#..."
       ".####.###."]
      35

      [".#..#..###"
       "####.###.#"
       "....###.#."
       "..###.##.#"
       "##.##.#.#."
       "....###..#"
       "..#.#..#.#"
       "#..#.#.###"
       ".##...##.#"
       ".....#.#.."]
      41

      [".#..##.###...#######"
       "##.############..##."
       ".#.######.########.#"
       ".###.#######.####.#."
       "#####.##.#.##.###.##"
       "..#####..#.#########"
       "####################"
       "#.####....###.#.#.##"
       "##.#################"
       "#####.##.###..####.."
       "..######..##.#######"
       "####.##.####...##..#"
       ".#####..#.######.###"
       "##...#.##########..."
       "#.##########.#######"
       ".####.#.###.###.#.##"
       "....##.##.###..#####"
       ".#.#.###########.###"
       "#.#.#.#####.####.###"
       "###.##.####.##.#..##"]
      210
      )))
